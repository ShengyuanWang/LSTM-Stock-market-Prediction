df1 <- df %>%
filter(index >= 90,
index < 100)
ggplot(data = df1) +
geom_line(mapping = aes(x = index,
y = value,
color = type)) +
theme_minimal()
df1 <- df %>%
filter(index >= 90,
index < 200)
ggplot(data = df1) +
geom_line(mapping = aes(x = index,
y = value,
color = type)) +
theme_minimal()
df1 <- df %>%
filter(index >= 90,
index < 150)
ggplot(data = df1) +
geom_line(mapping = aes(x = index,
y = value,
color = type)) +
theme_minimal()
df1 <- df %>%
filter(index >= 90,
index < 1000)
ggplot(data = df1) +
geom_line(mapping = aes(x = index,
y = value,
color = type)) +
theme_minimal()
df1 <- df %>%
filter(index >= 90,
index < 500)
ggplot(data = df1) +
geom_line(mapping = aes(x = index,
y = value,
color = type)) +
theme_minimal()
df1 <- df %>%
filter(index >= 450,
index < 500)
ggplot(data = df1) +
geom_line(mapping = aes(x = index,
y = value,
color = type)) +
theme_minimal()
df1 <- df %>%
filter(index >= 0,
index < 60)
ggplot(data = df1) +
geom_line(mapping = aes(x = index,
y = value,
color = type)) +
theme_minimal()
df1 <- df %>%
filter(index >= 0,
index < 5)
ggplot(data = df1) +
geom_line(mapping = aes(x = index,
y = value,
color = type)) +
theme_minimal()
df1 <- df %>%
filter(index >= 0,
index < 6)
ggplot(data = df1) +
geom_line(mapping = aes(x = index,
y = value,
color = type)) +
theme_minimal()
df1 <- df %>%
filter(index >= 0,
index < 7)
ggplot(data = df1) +
geom_line(mapping = aes(x = index,
y = value,
color = type)) +
theme_minimal()
df1 <- df %>%
filter(index >= 0,
index < 8)
ggplot(data = df1) +
geom_line(mapping = aes(x = index,
y = value,
color = type)) +
theme_minimal()
# Plot the output
df <- data.frame(
index = 1:length(dataset),
value = dataset * spread + min_value,
type = 'raw'
) %>%
rbind(data.frame(
index = 1:length(trainPredict) + look_back,
value = trainPredict,
type = 'train'
)) %>%
rbind(data.frame(
index = 1:length(testPredict) + look_back + length(train),
value = testPredict,
type = 'test'
))
ggplot(data = df) +
geom_line(mapping = aes(x = index,
y = value,
color = type)) +
geom_vline(xintercept = length(train) + 0.5) +
theme_minimal()
model %>%
predict(1)
model %>%
predict(0.057)
# Initialize the model
model <- keras_model_sequential()
# Train the model
trained_model <- model %>%
layer_lstm(units = 4,
input_shape = c(1, look_back)) %>%
layer_dense(units = 1) %>%
compile(loss = 'mean_squared_error',
optimizer = 'adam') %>%
fit(
trainXY$dataX,
trainXY$dataY,
epochs = 20,
batch_size = 73,
verbose = 1,
validation_split = 0.25
)
plot(trained_model)
# Initialize the model
model <- keras_model_sequential()
# Train the model
trained_model <- model %>%
layer_lstm(units = 4,
input_shape = c(1, look_back)) %>%
layer_dense(units = 1) %>%
compile(loss = 'mean_squared_error',
optimizer = 'adam') %>%
fit(
trainXY$dataX,
trainXY$dataY,
epochs = 20,
batch_size = 73,
verbose = 1,
validation_split = 0.25
)
plot(trained_model)
# Fit the model to get predicted value
trainPredict <- model %>%
predict(trainXY$dataX,
verbose = 1)
testPredict <- model %>%
predict(testXY$dataX,
verbose = 1)
trainPredict <- trainPredict * spread + min_value
testPredict <- testPredict * spread + min_value
# Plot the output
df <- data.frame(
index = 1:length(dataset),
value = dataset * spread + min_value,
type = 'raw'
) %>%
rbind(data.frame(
index = 1:length(trainPredict) + look_back,
value = trainPredict,
type = 'train'
)) %>%
rbind(data.frame(
index = 1:length(testPredict) + look_back + length(train),
value = testPredict,
type = 'test'
))
ggplot(data = df) +
geom_line(mapping = aes(x = index,
y = value,
color = type)) +
geom_vline(xintercept = length(train) + 0.5) +
theme_minimal()
# Save the model
saveRDS(trained_model, "LSTM_model.rds")
dataset
# Save the model
#saveRDS(trained_model, "LSTM_model.dep")
# Save the model
saveRDS(trained_model, "LSTM_model.dep")
trainPredict
# Save the model
model %>% save_model_tf("model")
list.files("model")
input = c(1,2,3)
trainPredict <- model %>%
predict(input)
input <- trainXY$dataX
trainPredict <- model %>%
predict(input)
trainPredict
input
input <- trainXY$dataX %>%
head()
input
trainXY$dataX
trainPredict <- model %>%
predict(input)
trainPredict
input1 <- trainXY$dataX %>%
head()
input2 <- testXY$dataX %>%
head()
trainPredict <- model %>%
predict(input1)
testPredict <- model %>%
predict(input2)
trainPredict <- trainPredict * spread + min_value
testPredict <- testPredict * spread + min_value
trainPredict
input2
trainXY
trainXY$dataX %>%
head()
trainXY %>%
head()
trainXY$dataY %>%
head()
trainXY$dataY
trainXY$dataY %>%
head()
trainXY$dataY
# Save the predicted numbers
df %>%
filter(type %in% c("test", "train"))
# Save the predicted numbers
result <- df %>%
filter(type %in% c("test", "train")) %>%
select(index, value)
bitcoin_data %>% cbind(result)
df %>%
filter(index >= 1460)
df %>%
filter(index >= 1460) %>%
ggplot(aes(x = index,
y = value,
color = type)) +
geom_line()
df %>%
filter(index >= 1460,
index <= 1470) %>%
ggplot(aes(x = index,
y = value,
color = type)) +
geom_line()
df %>%
filter(index >= 1460,
index <= 1467) %>%
ggplot(aes(x = index,
y = value,
color = type)) +
geom_line()
df %>%
filter(type %in% c("test", "train")) %>%
select(index, value)
# Save the predicted numbers
a <- c(1,2,3,4,5)
b <- c(0,0,0,0,0)
empty_data <- cbind(a,b)
result <- df %>%
filter(type %in% c("test", "train")) %>%
select(index, value) %>%
bitcoin_data %>% cbind(result)
empty_data
df
# Save the predicted numbers
index <- c(1,2,3,4,5)
value <- c(0,0,0,0,0)
empty_data <- cbind(index,value)
result <- df %>%
filter(type %in% c("test", "train")) %>%
select(index, value) %>%
rbind(empty_data) %>%
arrange(index)
bitcoin_data %>% cbind(result)
df %>%
filter(type %in% c("test", "train")) %>%
select(index, value) %>%
rbind(empty_data) %>%
arrange(index)
index_1 <- c(1,2,3,4,5)
index_2 <- c(1858,1859,1860,1861,1862)
value <- c(0,0,0,0,0)
empty_data_1 <- cbind(index_1,value)
empty_data_2 <- cbind(index_2,value)
df %>%
filter(type %in% c("test", "train")) %>%
select(index, value) %>%
rbind(empty_data_1) %>%
arrange(index) %>%
mutate(index = ifelse(index >= 1460, index - 5, index))
df %>%
filter(type %in% c("test", "train")) %>%
select(index, value) %>%
rbind(empty_data_1) %>%
arrange(index) %>%
mutate(index_new = ifelse(index >= 1460, index - 5, index))
df %>%
filter(type %in% c("test", "train")) %>%
select(index, value) %>%
rbind(empty_data_1) %>%
arrange(index)
df %>%
filter(type %in% c("test", "train")) %>%
select(index, value)
df %>%
filter(type %in% c("test", "train")) %>%
select(index, value) %>%
rbind(empty_data_1)
empty_data_1
index <- c(1,2,3,4,5)
value <- c(0,0,0,0,0)
empty_data_1 <- cbind(index,value)
index <- c(1858,1859,1860,1861,1862)
empty_data_2 <- cbind(index,value)
empty_data_1
empty_data_2
df %>%
filter(type %in% c("test", "train")) %>%
select(index, value) %>%
rbind(empty_data_1) %>%
arrange(index) %>%
mutate(index_new = ifelse(index >= 1460, index - 5, index))
index <- c(1,2,3,4,5)
value <- c(0,0,0,0,0)
empty_data_1 <- cbind(index,value)
index <- c(1822,1823,1824,1825,1826)
empty_data_2 <- cbind(index,value)
df %>%
filter(type %in% c("test", "train")) %>%
select(index, value) %>%
rbind(empty_data_1) %>%
arrange(index) %>%
mutate(index_new = ifelse(index >= 1460, index - 5, index))
df %>%
filter(type %in% c("test", "train")) %>%
select(index, value) %>%
rbind(empty_data_1) %>%
mutate(index_new = ifelse(index >= 1460, index - 5, index)) %>%
rbind(empty_data_2) %>%
arrange(index)
index <- c(1,2,3,4,5)
value <- c(0,0,0,0,0)
empty_data_1 <- cbind(index,value)
index <- c(1822,1823,1824,1825,1826)
empty_data_2 <- cbind(index,value)
empty_data_1
empty_data_2
df %>%
filter(type %in% c("test", "train")) %>%
select(index, value) %>%
rbind(empty_data_1) %>%
mutate(index = ifelse(index >= 1460, index - 5, index)) %>%
rbind(empty_data_2) %>%
arrange(index)
bitcoin_data %>% cbind(result)
result <- df %>%
filter(type %in% c("test", "train")) %>%
select(index, value) %>%
rbind(empty_data_1) %>%
mutate(index = ifelse(index >= 1460, index - 5, index)) %>%
rbind(empty_data_2) %>%
arrange(index)
bitcoin_data %>% cbind(result)
bitcoin_data %>%
cbind(result) %>%
select(Date, value)
(bitcoin_result, "prediction/bitcoin_LSTM_result.csv")
bitcoin_result
bitcoin_result
bitcoin_result <- bitcoin_data %>%
cbind(result) %>%
select(Date, value)
bitcoin_result
write.csv(bitcoin_result, "prediction/bitcoin_LSTM_result.csv")
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(ggplot2)
library(tseries)
library(forecast)
theme_set(theme_minimal())
set.seed(123)
# Load the data & clean the data
bitcoin_data <- read.csv("data/BCHAIN-MKPRU.csv") %>%
mutate(Date = as.Date(Date, "%m/%d/%y")) %>%
na.omit()
gold_data <- read.csv("data/LBMA-GOLD.csv") %>%
mutate(Date = as.Date(Date, "%m/%d/%y")) %>%
na.omit()
# Visualize the data
bitcoin_data %>%
ggplot(aes(x = Date,
y = Value)) +
geom_line()
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(ggplot2)
library(tseries)
library(forecast)
theme_set(theme_minimal())
set.seed(123)
# Load the data & clean the data
bitcoin_data <- read.csv("data/BCHAIN-MKPRU.csv") %>%
mutate(Date = as.Date(Date, "%m/%d/%y")) %>%
na.omit()
gold_data <- read.csv("data/LBMA-GOLD.csv") %>%
mutate(Date = as.Date(Date, "%m/%d/%y")) %>%
na.omit()
# Visualize the data
bitcoin_data %>%
ggplot(aes(x = Date,
y = Value)) +
geom_line()
dataset = bitcoin_data$Value
train_size <- as.integer(length(dataset) * 0.8)
test_size <- length(dataset) - train_size
train <- dataset[1:train_size]
test <- dataset[(train_size + 1):length(dataset)]
# Visualize the time series
plot(diff(log(train)),type='l', main='log returns plot')
# Dickey Fuller Test of Stationary
adf.test(diff(log(train)), alternative="stationary", k=0)
# Using ACF and PACF to determine the parameters
acf(diff(log(train)))
pacf(diff(log(train)))
# Fit the ARIMA model; AIC lower, the model is better
fit <- arima(diff(log(train)), c(1, 0, 1))
# To see which set of parameters is best for the model
fitARIMA <- auto.arima(diff(log(train)), trace=TRUE)
plot(as.ts(diff(log(train))) )
lines(fitted(fitARIMA), col="red")
futurVal <- forecast(fitARIMA,h=1, level=c(99)) #confidence level 99%
plot(forecast(futurVal))
value <- bitcoin_data$Value[1:5]
model_arima <- function(result, listIn)
{
temp = result
for (i in 5:length(listIn))
{
train_data <- listIn[1:i]
fitARIMA <- auto.arima((log(train_data)), trace = FALSE)
predARIMA <- forecast(fitARIMA, h = 1, level = c(99))
pred <- as.numeric(predARIMA$mean)
new_value <- 2 ^ pred
temp = c(temp, new_value)
print(i+1)
print(new_value)
}
return(temp)
}
value <- model_arima(value, bitcoin_data$Value)
train
fitARIMA <- auto.arima(train, trade = FALSE)
dataset = bitcoin_data$Value
train_size <- as.integer(length(dataset) * 0.8)
test_size <- length(dataset) - train_size
train <- dataset[1:train_size]
test <- dataset[(train_size + 1):length(dataset)]
fitARIMA <- auto.arima(train, trade = FALSE)
fitARIMA <- auto.arima(train, trace = FALSE)
predARIMA <- forecast(fitARIMA, h = 1, level = c(99))
as.numeric(predARIMA$mean)
as.numeric(predARIMA$mean)
predARIMA <- forecast(fitARIMA, h = 366, level = c(99))
as.numeric(predARIMA$mean)
bitcoin_data
train
View(bitcoin_data)
cbind(train, "Type")
fitARIMA <- auto.arima(train, trace = FALSE)
predARIMA <- forecast(fitARIMA, h = 366, level = c(99))
validation <- as.numeric(predARIMA$mean)
cbind(train, "Type"="train")
fitARIMA <- auto.arima(train, trace = FALSE)
predARIMA <- forecast(fitARIMA, h = 366, level = c(99))
validation <- as.numeric(predARIMA$mean)
cbind(value = train, "Type" = "train")
bitcoin_arima <- cbind(value = train, "Type" = "train")
bitcoin_arima <- cbind(value = train, "Type" = "train")
bitcoin_arima %>%
rbind(cbind(value = test, "Type" = "test"))
cbind(value = train, index = 1:1460, "Type" = "train")
bitcoin_arima <- cbind(index = 1:1460, value = train, Type = "train") %>%
rbind(cbind(index = 1461:1826, value = test, Type = "test")) %>%
rbind(cbind(index = 1461:1826, value = validation, Type = "validation"))
ggplot(data = bitcoin_arima) %>%
geom_line(mapping = aes(x = index,
y = value,
color = Type))
bitcoin_arima %>%
ggplot(aes(x = index, y = value, color = Type)) +
geom_line()
bitcoin_arima
data.frame(lapply(bitcoin_arima, type.convert), stringsAsFactors=FALSE)
fitARIMA <- auto.arima(train, trace = FALSE)
predARIMA <- forecast(fitARIMA, h = 366, level = c(99))
validation <- as.numeric(predARIMA$mean)
bitcoin_arima <- cbind(index = 1:1460, value = train, Type = "train") %>%
rbind(cbind(index = 1461:1826, value = test, Type = "test")) %>%
rbind(cbind(index = 1461:1826, value = validation, Type = "validation"))
data.frame(lapply(bitcoin_arima, type.convert), stringsAsFactors=FALSE)
bitcoin_arima %>%
ggplot(aes(x = index, y = value, color = Type)) +
geom_line()
